<section class="content">
    <div class="content-block">
        <div class="block-header">
            <app-breadcrumb [title]="'Pesalink Bulk Processing'" [items]="['Outgoing Pesalink']"
                [active_item]="'Bulk Upload'">
            </app-breadcrumb>
        </div>

        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="card down">
                    <div class="body">
                        <form>
                            <div class="row">

                                <div class="col-xl-10 col-lg-10 col-md-8 col-sm-8 mb-3">
                                    <mat-label>Upload Excel File</mat-label>

                                    <app-file-upload (change)="selectFile($event)">
                                    </app-file-upload>

                                </div>
                                <div *ngIf="currentFile" class="progress">
                                    <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar"
                                        attr.aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100"
                                        [ngStyle]="{ width: progress + '%' }">
                                        {{ progress }}%
                                    </div>
                                </div>
                                <div class="col-xl-2 col-lg-2 col-md-4 col-sm-4">
                                    <div class="container mt-4">
                                        <div class="row align-items-center">
                                            <div class="col"></div>
                                            <div class="col">
                                                <div class="m-l-3 m-b-3">
                                                    <button mat-flat-button color="primary" *ngIf="valid" type="submit"
                                                        class="msr-2 mb-2 mt-2" (click)="submit()"
                                                        [class.auth-spinner]="loading" [disabled]="loading">
                                                        <b>Submit</b>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="col"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-3" *ngIf="this.valid">
                                    <mat-progress-bar *ngIf="this.loading" mode="indeterminate"></mat-progress-bar>

                                    <mat-label class="m-3">Preview of The Excel Data</mat-label>
                                    <div class="table-responsive">
                                        <div class="materialTableHeader">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <ul class="header-buttons-left ms-0">
                                                        <li class="dropdown m-l-0">
                                                            <label for="search-input"><i
                                                                    class="material-icons search-icon">search</i></label>
                                                            <input placeholder="Search" type="text"
                                                                style="text-transform: capitalize;"
                                                                (keyup)="applyFilter($event)"
                                                                class="browser-default search-field"
                                                                aria-label="Search box" />
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="col-md 6 m-3">
                                                    <mat-label>Uploaded Transactions {{ finalValues.length}}</mat-label>
                                                </div>

                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="card down">
                                                    <div class="body">
                                                        <div class="table-responsive">
                                                            <mat-table #table [dataSource]="dataSource" matSort
                                                                class="mat-cell">
                                                                <!-- ID Column -->
                                                                <ng-container matColumnDef="id">
                                                                    <mat-header-cell *matHeaderCellDef
                                                                        class="table-img tbl-col-width-per-8"
                                                                        mat-sort-header>#</mat-header-cell>
                                                                    <mat-cell class="table-img tbl-col-width-per-8"
                                                                        *matCellDef="let element; let i = index"
                                                                        [class.odd-row]="i % 2"
                                                                        [class.even-row]="!(i % 2)">{{i +
                                                                        1}}</mat-cell>
                                                                </ng-container>
                                                                <ng-container matColumnDef="drAccount">
                                                                    <mat-header-cell *matHeaderCellDef mat-sort-header
                                                                        class="column-nowrap">Debit
                                                                        Account</mat-header-cell>
                                                                    <mat-cell *matCellDef="let row;let i = index"
                                                                        [class.odd-row]="i % 2"
                                                                        [class.even-row]="!(i % 2)"
                                                                        class="column-nowrap">
                                                                        {{row.drAccount}}
                                                                    </mat-cell>
                                                                </ng-container>

                                                                <ng-container matColumnDef="amount">
                                                                    <mat-header-cell *matHeaderCellDef mat-sort-header
                                                                        class="column-nowrap">Tran
                                                                        Amount</mat-header-cell>
                                                                    <mat-cell *matCellDef="let row;let i = index"
                                                                        [class.odd-row]="i % 2"
                                                                        [class.even-row]="!(i % 2)"
                                                                        class="column-nowrap">
                                                                        {{row.amount}}
                                                                    </mat-cell>
                                                                </ng-container>

                                                                <ng-container matColumnDef="recptType">
                                                                    <mat-header-cell *matHeaderCellDef mat-sort-header
                                                                        class="column-nowrap">Recipient
                                                                        Type</mat-header-cell>
                                                                    <mat-cell *matCellDef="let row;let i = index"
                                                                        [class.odd-row]="i % 2"
                                                                        [class.even-row]="!(i % 2)"
                                                                        class="column-nowrap">
                                                                        {{row.recptType}}
                                                                    </mat-cell>
                                                                </ng-container>

                                                                <ng-container matColumnDef="recptAcct">
                                                                    <mat-header-cell *matHeaderCellDef mat-sort-header
                                                                        class="column-nowrap">Recipient
                                                                        Account</mat-header-cell>
                                                                    <mat-cell *matCellDef="let row;let i = index"
                                                                        [class.odd-row]="i % 2"
                                                                        [class.even-row]="!(i % 2)"
                                                                        class="column-nowrap">
                                                                        {{row.recptAcct}}
                                                                    </mat-cell>
                                                                </ng-container>

                                                                <ng-container matColumnDef="benBank">
                                                                    <mat-header-cell *matHeaderCellDef mat-sort-header
                                                                        class="column-nowrap">Beneficiary
                                                                        Bank</mat-header-cell>
                                                                    <mat-cell *matCellDef="let row;let i = index"
                                                                        [class.odd-row]="i % 2"
                                                                        [class.even-row]="!(i % 2)"
                                                                        class="column-nowrap">
                                                                        {{row.benBank}}
                                                                    </mat-cell>
                                                                </ng-container>

                                                                <ng-container matColumnDef="narration">
                                                                    <mat-header-cell *matHeaderCellDef mat-sort-header
                                                                        class="column-nowrap">Narration</mat-header-cell>
                                                                    <mat-cell *matCellDef="let row;let i = index"
                                                                        [class.odd-row]="i % 2"
                                                                        [class.even-row]="!(i % 2)"
                                                                        class="column-nowrap">
                                                                        {{row.narration}}
                                                                    </mat-cell>
                                                                </ng-container>
                                                                <mat-header-row
                                                                    *matHeaderRowDef="displayedColumns"></mat-header-row>
                                                                <mat-row *matRowDef="let row; columns: displayedColumns"
                                                                    (click)="rowDetailsCall(row)"
                                                                    [style.cursor]="'pointer'" matRipple>
                                                                </mat-row>
                                                            </mat-table>
                                                            <mat-paginator #paginator [pageIndex]="0" [pageSize]="10"
                                                                [pageSizeOptions]="[10, 25,50, 100]">
                                                            </mat-paginator>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>